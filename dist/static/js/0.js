webpackJsonp([0],{306:function(e,t,a){"use strict";function s(e){a(310)}Object.defineProperty(t,"__esModule",{value:!0});var r=a(308),n=a.n(r);for(var o in r)"default"!==o&&function(e){a.d(t,e,function(){return r[e]})}(o);var u=a(317),i=a(17),c=s,l=i(n.a,u.a,!1,c,"data-v-83efbd52",null);t.default=l.exports},308:function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(24),n=s(r),o=a(25),u=s(o),i=a(65),c=s(i),l=a(36),p=a(312),d=s(p),f=a(109),h=s(f),m=new h.default;t.default={name:"Menu",components:{SnapshotsUpload:d.default},data:function(){return{snapshotRequests:[],clientId:this.$route.params.clId,projectId:this.$route.params.prId}},computed:(0,c.default)({},(0,l.mapGetters)(["getSuccessMessage","getSuccessStatus"])),created:function(){this.loadSnapshotRequests()},methods:{loadSnapshotRequests:function(){var e=this;return(0,u.default)(n.default.mark(function t(){var a;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.getSnapshotRequests(e.clientId,e.projectId);case 3:a=t.sent,e.snapshotRequests=a.data,t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}},t,e,[[0,7]])}))()}}}},309:function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function r(){return{imageFile:"",localImageDisplay:"",snapshot:{imageUrl:"",comment:""}}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(66),o=s(n),u=a(24),i=s(u),c=a(25),l=s(c),p=a(65),d=s(p),f=a(36),h=a(67),m=a(108),v=s(m),g=a(315),_=s(g),S=a(68),y=s(S),b=new y.default,x=new v.default,U=new _.default;t.default={name:"SnapshotsUpload",props:{"request-id":{type:String,required:!0},"request-name":{type:String,required:!0},"request-sequence":{type:Number,required:!0}},data:function(){return{successMessage:"Thank you for your feedback - keep 'em coming!",snapshotData:r()}},validations:{snapshotData:{snapshot:{comment:{required:h.required}},imageFile:{required:h.required}}},computed:{commentErrors:function(){var e=[];return this.$v.snapshotData.snapshot.comment.$error&&e.push("Please provide a comment"),e}},methods:(0,d.default)({},(0,f.mapMutations)(["UPDATE_SUCCESS_STATUS","UPDATE_SUCCESS_MESSAGE"]),{addImage:function(e){if(e){this.snapshotData.imageFile=e;var t=URL.createObjectURL(e);this.snapshotData.localImageDisplay=t}},saveSnapshot:function(){var e=this;return(0,l.default)(i.default.mark(function t(){var a,s;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.areSnapshotParametersValid()){t.next=16;break}return t.prev=1,t.next=4,e.getImageUploadConfig();case 4:return a=t.sent,e.uploadImage(a.signedImageUploadUrl),e.snapshotData.snapshot.imageUrl=a.imageUrl,t.next=9,e.saveFullSnapshotRecord();case 9:s=t.sent,200===s.status&&e.informUserSaveSuccessful(),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),b.handleError(t.t0);case 16:case"end":return t.stop()}},t,e,[[1,13]])}))()},areSnapshotParametersValid:function(){return this.$v.$touch(),!this.$v.$error&&(this.$v.$reset(),!0)},getImageUploadConfig:function(){var e=this;return(0,l.default)(i.default.mark(function t(){var a;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.getImageUploadConfig({params:{imageFileName:Date.now()}});case 3:return a=e.sent,e.abrupt("return",a.data);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}},t,e,[[0,7]])}))()},uploadImage:function(e){var t={headers:{"Content-Type":this.snapshotData.imageFile.type}};U.putImage(e,this.snapshotData.imageFile,t)},saveFullSnapshotRecord:function(){var e=this;return(0,l.default)(i.default.mark(function t(){var a,s;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=(0,o.default)({},e.snapshotData.snapshot),a.requestId=e.requestId,t.next=5,x.postSnapshot(a);case 5:return s=t.sent,t.abrupt("return",s);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},informUserSaveSuccessful:function(){var e=this;this.reset(),this.UPDATE_SUCCESS_MESSAGE(this.successMessage),this.UPDATE_SUCCESS_STATUS(!0),setTimeout(function(){e.UPDATE_SUCCESS_STATUS(!1)},4e3)},reset:function(){var e=r();(0,o.default)(this.$data.snapshotData,e)}})}},310:function(e,t,a){var s=a(311);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);a(305)("59195aed",s,!0,{})},311:function(e,t,a){t=e.exports=a(304)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"SnapshotsUploadList.vue",sourceRoot:""}])},312:function(e,t,a){"use strict";function s(e){a(313)}Object.defineProperty(t,"__esModule",{value:!0});var r=a(309),n=a.n(r);for(var o in r)"default"!==o&&function(e){a.d(t,e,function(){return r[e]})}(o);var u=a(316),i=a(17),c=s,l=i(n.a,u.a,!1,c,"data-v-cd62eb1e",null);t.default=l.exports},313:function(e,t,a){var s=a(314);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);a(305)("25dc0ec0",s,!0,{})},314:function(e,t,a){t=e.exports=a(304)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"SnapshotsUpload.vue",sourceRoot:""}])},315:function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(37),n=s(r),o=a(18),u=s(o),i=a(26),c=s(i),l=a(38),p=s(l),d=a(39),f=s(d),h=a(40),m=s(h),v=function(e){function t(){return(0,u.default)(this,t),(0,p.default)(this,(t.__proto__||(0,n.default)(t)).call(this,{baseURL:""}))}return(0,f.default)(t,e),(0,c.default)(t,[{key:"putImage",value:function(e,t,a){this.axios.put(e,t,a)}}]),t}(m.default);t.default=v},316:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{id:"uploadContainer",fluid:"","grid-list-lg":""}},[a("v-layout",{attrs:{row:"","justify-center":"","align-center":"",wrap:""}},[a("v-flex",{attrs:{xs12:"",s4:"",md3:""}},[a("h2",{staticClass:"request-title"},[e._v(e._s(e.requestName))]),e._v(" "),a("v-card",{attrs:{flat:"",color:"transparent"}},[e.snapshotData.localImageDisplay?a("v-card-media",{attrs:{id:"snapshotImage",src:e.snapshotData.localImageDisplay,contain:"",height:"200px"}}):e._e()],1)],1)],1),e._v(" "),a("v-layout",{attrs:{row:"","justify-center":"","align-center":"",wrap:""}},[a("v-flex",{attrs:{xs12:"",s4:"",md3:""}},[a("label",{staticClass:"btn btn-file btn--block secondary",attrs:{id:e.requestId}},[e._v("\n        Tap here to take a photo of your space\n        "),a("input",{staticStyle:{display:"none"},attrs:{id:"addImage",type:"file",accept:"image/*",capture:"camera"},on:{change:function(t){e.addImage(t.target.files[0])}}})]),e._v(" "),e.$v.snapshotData.imageFile.$error?a("div",{staticClass:"input-group__messages \n    input-group__error input-group__details input-group--error \n    input-group--required error--text",attrs:{id:"imageError"}},[e._v("\n        Please add a photo")]):e._e()])],1),e._v(" "),a("v-layout",{attrs:{row:"","justify-center":"","align-center":"",wrap:""}},[a("v-flex",{attrs:{xs12:"",s4:"",md3:""}},[a("v-text-field",{staticClass:"spacelabThin",attrs:{id:"snapshotComment","error-messages":e.commentErrors,name:"input-7-1",label:"Tell us more about this","multi-line":"",required:"",rows:"2"},model:{value:e.snapshotData.snapshot.comment,callback:function(t){e.$set(e.snapshotData.snapshot,"comment",t)},expression:"snapshotData.snapshot.comment"}})],1)],1),e._v(" "),a("v-layout",{attrs:{row:"","justify-center":"","align-center":"",wrap:""}},[a("v-flex",{attrs:{xs12:"",s4:"",md3:""}},[a("v-btn",{staticClass:"secondary",attrs:{id:"submitSnapshot",block:""},on:{click:function(t){e.saveSnapshot()}}},[e._v("Submit")])],1)],1)],1)},r=[],n={render:s,staticRenderFns:r};t.a=n},317:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-layout",{attrs:{column:""}},[a("div",[a("v-alert",{attrs:{value:e.getSuccessStatus,transition:"scale-transition",type:"success",dismissible:""}},[e._v("\n      "+e._s(e.getSuccessMessage)+"\n    ")])],1),e._v(" "),a("div",{staticClass:"snapshots-upload-container"},e._l(e.snapshotRequests,function(e){return a("snapshots-upload",{key:e._id,ref:"snapshots",refInFor:!0,staticClass:"snapshot-upload",attrs:{"request-name":e.name,"request-id":e._id,"request-sequence":e.sequence}})}))])},r=[],n={render:s,staticRenderFns:r};t.a=n}});
//# sourceMappingURL=0.js.map